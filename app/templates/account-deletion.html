<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width'>
    <title>StellarIQ - Account Deletion Request</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        .bg-dark {
            background-color: #0f172a !important;
        }

        .container {
            background-color: #0f172a;
        }

        a:link, a:visited, a:active, a:hover {
            color: #94a3b8;
        }

        .card {
            border: 1px solid #334155;
            border-radius: 12px !important;
            background-color: #1e293b !important;
            color: #f1f5f9;
        }

        .btn-danger {
            background-color: #dc2626;
            border-color: #dc2626;
        }

        .btn-danger:hover {
            background-color: #b91c1c;
            border-color: #b91c1c;
        }

        .btn-secondary {
            background-color: #64748b;
            border-color: #64748b;
        }

        .btn-secondary:hover {
            background-color: #475569;
            border-color: #475569;
        }

        .form-control {
            background-color: #334155;
            border-color: #475569;
            color: #f1f5f9;
        }

        .form-control:focus {
            background-color: #334155;
            border-color: #6366f1;
            color: #f1f5f9;
            box-shadow: 0 0 0 0.2rem rgba(99, 102, 241, 0.25);
        }

        .form-control::placeholder {
            color: #94a3b8;
        }

        .alert-warning {
            background-color: #fbbf24;
            border-color: #f59e0b;
            color: #92400e;
        }

        .alert-danger {
            background-color: #fca5a5;
            border-color: #f87171;
            color: #991b1b;
        }

        .alert-success {
            background-color: #86efac;
            border-color: #4ade80;
            color: #166534;
        }
    </style>
</head>
<body>
<div class="bg-dark min-vh-100">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <h1 class="mb-4 text-center">Account Deletion Request</h1>
                        
                        {% if success %}
                        <div class="alert alert-success" role="alert">
                            <h4 class="alert-heading">Confirmation Email Sent!</h4>
                            <p>Your account deletion request has been received. <strong>To complete the deletion, you must click the confirmation link in the email we just sent to you.</strong></p>
                            <hr>
                            <p class="mb-0">
                                <strong>Next Steps:</strong><br>
                                1. Check your email at <strong>{{ email }}</strong><br>
                                2. Click the confirmation link in the email<br>
                                3. Your account will be immediately deleted upon confirmation
                            </p>
                            <p class="mt-2 mb-0"><small class="text-muted">The confirmation link expires in 24 hours. If you don't see the email, check your spam folder.</small></p>
                        </div>
                        {% elif error %}
                        <div class="alert alert-danger" role="alert">
                            <h4 class="alert-heading">Error</h4>
                            <p>{{ error }}</p>
                        </div>
                        {% endif %}

                        {% if not success %}
                        <div class="alert alert-warning" role="alert">
                            <h4 class="alert-heading">⚠️ Important Information</h4>
                            <p><strong>Account deletion is permanent and cannot be undone.</strong> Please review the following before proceeding:</p>
                            <ul class="mb-0">
                                <li>All your account data, including favorites, portfolios, and preferences will be permanently deleted</li>
                                <li>You will lose access to all StellarIQ services</li>
                                <li>This action cannot be reversed</li>
                                <li>You will receive an email confirmation link that expires in 24 hours</li>
                            </ul>
                        </div>

                        <form method="post" action="/account-deletion" class="mt-4">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" required 
                                       placeholder="Enter your account email address"
                                       value="{{ email or '' }}">
                                <div class="form-text text-muted">Enter the email address associated with your StellarIQ account.</div>
                            </div>

                            <div class="mb-3">
                                <label for="reason" class="form-label">Reason for Deletion (Optional)</label>
                                <select class="form-control" id="reason" name="reason">
                                    <option value="">Select a reason (optional)</option>
                                    <option value="no_longer_needed">No longer needed</option>
                                    <option value="privacy_concerns">Privacy concerns</option>
                                    <option value="switching_services">Switching to another service</option>
                                    <option value="technical_issues">Technical issues</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="additional_info" class="form-label">Additional Information (Optional)</label>
                                <textarea class="form-control" id="additional_info" name="additional_info" rows="3" 
                                          placeholder="Any additional information or feedback..."></textarea>
                            </div>

                            <div class="mb-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="confirm_deletion" name="confirm_deletion" required>
                                    <label class="form-check-label" for="confirm_deletion">
                                        I understand that this action is permanent and cannot be undone. I want to permanently delete my StellarIQ account and all associated data.
                                    </label>
                                </div>
                            </div>

                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <a href="/" class="btn btn-secondary me-md-2">Cancel</a>
                                <button type="submit" class="btn btn-danger">Send Deletion Request</button>
                            </div>
                        </form>
                        {% endif %}

                        <hr class="my-4">
                        
                        <div class="text-center">
                            <h5>Need Help?</h5>
                            <p class="text-muted">
                                If you have questions about account deletion or data privacy, 
                                please contact us at <a href="mailto:chris@stellariq.app">chris@stellariq.app</a>
                            </p>
                            <p class="text-muted">
                                <a href="/privacy-policy">View our Privacy Policy</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
